{% extends 'base.html' %}
{% load static %}
{% block content %}
<h2>–ú–æ–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã</h2>

<form method="get" class="filter-form">
    <input type="text" name="q" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..." value="{{ search_query }}">
    <select name="category">
        <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
        {% for cat in categories %}
        <option value="{{ cat.id }}" {% if selected_category == cat.id %}selected{% endif %}>
            {{ cat.name }}
        </option>
        {% endfor %}
    </select>
    <button type="submit">üîç</button>
</form>

{% if favorites %}
<div class="container">
    {% comment %} –î–æ–±–∞–≤–∏–ª –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —á—Ç–æ–±—ã —Ä–µ—Ü–µ–ø—Ç—ã –Ω–µ –ø—Ä–∏–ª–∏–ø–∞–ª–∏ –∫ –∫—Ä–∞—è–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã {% endcomment %}
    <div class="recipe-grid">
        {% for fav in favorites %}
        <div class="recipe-card">
            <a href="{% url 'recipe_detail' fav.recipe.id %}">
                {% if fav.recipe.image %}
                    <img src="{{ fav.recipe.image.url }}" alt="{{ fav.recipe.title }}">
                {% else %}
                    <img src="{% static 'images/no-image.jpg' %}" alt="–ù–µ—Ç —Ñ–æ—Ç–æ">
                {% endif %}
            </a>

            {# –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ó–∞–º–µ–Ω—è–µ–º recipe-info –Ω–∞ recipe-card-content #}
            <div class="recipe-card-content">
                <h3>{{ fav.recipe.title }}</h3>
                <p class="category">{{ fav.recipe.category.name }}</p>
                <p>{{ fav.recipe.description|truncatewords:20 }}</p>

                {# –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ "–£–¥–∞–ª–∏—Ç—å" –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –∫–ª–∞—Å—Å–æ–º favorite-button #}
                <form action="{% url 'favorite_toggle' fav.recipe.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="favorite-button remove">‚òÖ –£–¥–∞–ª–∏—Ç—å</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{# –ü–∞–≥–∏–Ω–∞—Ü–∏—è, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å, –¥–æ–ª–∂–Ω–∞ –∏–¥—Ç–∏ –ø–æ—Å–ª–µ recipe-grid #}
{% else %}
<p>–í—ã –µ—â—ë –Ω–µ –¥–æ–±–∞–≤–∏–ª–∏ —Ä–µ—Ü–µ–ø—Ç—ã –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ.</p>
{% endif %}
{% endblock %}